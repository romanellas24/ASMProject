<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <title>Dashboard Ristorante</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Bootstrap 5 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            padding-top: 3rem;
            background-color: #f0f2f5;
        }
        .card {
            transition: transform 0.2s ease-in-out;
            cursor: pointer;
        }
        .card:hover {
            transform: scale(1.02);
        }
        .card.disabled {
            pointer-events: none;
            opacity: 0.5;
        }
    </style>
</head>
<body>

<!-- Barra superiore -->
<nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm fixed-top">
    <div class="container-fluid">
        <span class="navbar-brand mb-0 h1">Dashboard Ristorante</span>
        <div class="d-flex">
            <button id="authButton" class="btn btn-outline-danger" onclick="logout()">Logout</button>
        </div>
    </div>
</nav>

<div class="container text-center" style="margin-top: 6rem;">
    <div id="loginMessage" class="alert alert-warning d-none" role="alert">
        Effettua il login per accedere alle funzionalitÃ .
    </div>

    <div class="row justify-content-center">
        <!-- Card MenÃ¹ -->
        <div class="col-md-4 mb-4">
            <div id="menuCard" class="card shadow" onclick="redirectTo('menu')">
                <div class="card-body">
                    <h5 class="card-title">ðŸ“‹ Seleziona MenÃ¹ del Giorno</h5>
                    <p class="card-text">Scegli i piatti da servire oggi tramite checkbox.</p>
                </div>
            </div>
        </div>
        <!-- Card Ordini -->
        <div class="col-md-4 mb-4">
            <div id="waitingOrdersCard" class="card shadow" onclick="redirectTo('waitingorders')">
                <div class="card-body">
                    <h5 class="card-title">ðŸ§¾ Gestisci Ordini</h5>
                    <p class="card-text">Accetta o rifiuta gli ordini in tempo reale.</p>
                </div>
            </div>
        </div>
        <!-- Card Visualizza Ordini -->
        <div class="col-md-4 mb-4">
            <div id="ordersCard" class="card shadow" onclick="redirectTo('orders')">
                <div class="card-body">
                    <h5 class="card-title">ðŸ“‹ Visualizza gli ordini</h5>
                    <p class="card-text">Visualizza gli ordini di oggi.</p>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    const BASE_URL = "[[${beUrl}]]";
    const jwtToken = localStorage.getItem("jwt");

    function redirectTo(endPath) {
        location.href = 'https://' + BASE_URL + '/' + endPath;
    }

    function logout() {
        localStorage.removeItem("jwt");
        window.location.href = "/auth/login";
    }

    window.addEventListener('DOMContentLoaded', () => {
        const authButton = document.getElementById('authButton');
        const loginMessage = document.getElementById('loginMessage');
        const menuCard = document.getElementById('menuCard');
        const waitingOrdersCard = document.getElementById('waitingOrdersCard');

        if (!jwtToken) {
            // Cambia bottone in "Login"
            authButton.textContent = "Login";
            authButton.onclick = () => window.location.href = "/auth/login";
            authButton.classList.remove("btn-outline-danger");
            authButton.classList.add("btn-outline-primary");

            // Mostra messaggio login necessario
            loginMessage.classList.remove("d-none");

            // Disabilita le card sensibili
            menuCard.classList.add("disabled");
            waitingOrdersCard.classList.add("disabled");
        }
    });
</script>

</body>
</html>
